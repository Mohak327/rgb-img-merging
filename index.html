<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prokudin-Gorskii Image Alignment Results</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background-color: #f8f9fa;
        }
        .header {
            text-align: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
        .section {
            background: white;
            margin: 30px 0;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .section h2 {
            color: #333;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .image-result {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background: #fafafa;
        }
        .image-result img {
            width: 100%;
            height: auto;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        .image-result h4 {
            margin: 0 0 10px 0;
            color: #333;
        }
        .offset-table {
            background: #f1f3f4;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .method-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .single-scale {
            background: #e3f2fd;
            color: #1565c0;
        }
        .multi-scale {
            background: #f3e5f5;
            color: #6a1b9a;
        }
        .algorithm-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .algorithm-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .bells-whistles {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .bells-whistles h3 {
            margin-top: 0;
            color: #d84315;
        }
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .feature-item {
            background: white;
            padding: 15px;
            border-radius: 5px;
            border-left: 3px solid #ff5722;
        }
        code {
            background: #f5f5f5;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        .failure-analysis {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 15px 0;
        }
        .file-stats {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #4caf50;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Prokudin-Gorskii Image Alignment</h1>
        <p>Automatic restoration of early color photographs using computer vision</p>
    </div>

    <div class="section">
        <h2>üìä Processing Summary</h2>
        <div class="file-stats">
            <h4>üìÅ Files Processed:</h4>
            <ul>
                <li><strong>3 JPEG files</strong> using single-scale alignment</li>
                <li><strong>11 main TIFF files</strong> using multi-scale pyramid alignment</li>
                <li><strong>3 additional master-pnp files</strong> from Library of Congress</li>
                <li><strong>Total: 17 images</strong> successfully processed</li>
            </ul>
        </div>
    </div>

    <div class="section">
        <h2>üéØ Project Overview</h2>
        <p>This project implements automatic alignment of Sergei Mikhailovich Prokudin-Gorskii's glass plate photographs (1907-1915). Each image contains three separate exposures (Blue, Green, Red) that need precise alignment to create stunning color photographs.</p>
        
        <div class="algorithm-section">
            <div class="algorithm-box">
                <h3>üîç Single-Scale Alignment</h3>
                <p><strong>For 3 JPEG files:</strong> cathedral.jpg, monastery.jpg, tobolsk.jpg</p>
                <ul>
                    <li>Exhaustive search over [-15, 15] pixel window</li>
                    <li>Sobel edge features for robustness</li>
                    <li>Normalized Cross-Correlation (NCC) scoring</li>
                    <li>Fast processing for small images</li>
                </ul>
            </div>
            <div class="algorithm-box">
                <h3>üî∫ Multi-Scale Pyramid</h3>
                <p><strong>For 14 TIFF files:</strong> All high-resolution glass plate scans</p>
                <ul>
                    <li>5-level pyramid with 2x downsampling</li>
                    <li>Coarse-to-fine alignment strategy</li>
                    <li>Handles large displacements efficiently</li>
                    <li>¬±2 pixel refinement at each level</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>üìä Single-Scale Alignment Results (3 JPEG Files)</h2>
        <p>Results using exhaustive search alignment on low-resolution images:</p>
        
        <div class="image-grid">
            <div class="image-result">
                <span class="method-badge single-scale">Single-Scale NCC</span>
                <h4>cathedral.jpg</h4>
                <img src="output/cathedral_restored.jpg" alt="Cathedral aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (5, 2)<br>
                    Red offset: (dy, dx) = (12, 3)<br>
                    Processing time: 0.8s
                </div>
            </div>
            <div class="image-result">
                <span class="method-badge single-scale">Single-Scale NCC</span>
                <h4>monastery.jpg</h4>
                <img src="output/monastery_restored.jpg" alt="Monastery aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (-3, 2)<br>
                    Red offset: (dy, dx) = (3, 2)<br>
                    Processing time: 0.7s
                </div>
            </div>
            <div class="image-result">
                <span class="method-badge single-scale">Single-Scale NCC</span>
                <h4>tobolsk.jpg</h4>
                <img src="output/tobolsk_restored.jpg" alt="Tobolsk aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (3, 3)<br>
                    Red offset: (dy, dx) = (6, 3)<br>
                    Processing time: 0.9s
                </div>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>üî∫ Multi-Scale Pyramid Results (11 Main TIFF Files)</h2>
        <p>Results using pyramid alignment on high-resolution glass plate scans:</p>
        
        <div class="image-grid">
            <div class="image-result">
                <span class="method-badge multi-scale">Pyramid NCC</span>
                <h4>church.tif</h4>
                <img src="output/church_restored.jpg" alt="Church aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (-1, -5)<br>
                    Red offset: (dy, dx) = (54, -6)<br>
                    Processing time: 13.9s
                </div>
            </div>
            <div class="image-result">
                <span class="method-badge multi-scale">Pyramid NCC + Edges</span>
                <h4>emir.tif</h4>
                <img src="output/emir_restored.jpg" alt="Emir aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (12, 8)<br>
                    Red offset: (dy, dx) = (109, 17)<br>
                    Processing time: 12.3s<br><strong>Note:</strong> Used edge-based features
                </div>
            </div>
            <div class="image-result">
                <span class="method-badge multi-scale">Pyramid NCC</span>
                <h4>harvesters.tif</h4>
                <img src="output/harvesters_restored.jpg" alt="Harvesters aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (119, -3)<br>
                    Red offset: (dy, dx) = (121, 7)<br>
                    Processing time: 15.7s
                </div>
            </div>
            <div class="image-result">
                <span class="method-badge multi-scale">Pyramid NCC</span>
                <h4>icon.tif</h4>
                <img src="output/icon_restored.jpg" alt="Icon aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (41, 16)<br>
                    Red offset: (dy, dx) = (90, 22)<br>
                    Processing time: 11.2s
                </div>
            </div>
            <div class="image-result">
                <span class="method-badge multi-scale">Pyramid NCC</span>
                <h4>italil.tif</h4>
                <img src="output/italil_restored.jpg" alt="Italil aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (38, 18)<br>
                    Red offset: (dy, dx) = (77, 34)<br>
                    Processing time: 13.1s
                </div>
            </div>
            <div class="image-result">
                <span class="method-badge multi-scale">Pyramid NCC</span>
                <h4>lastochikino.tif</h4>
                <img src="output/lastochikino_restored.jpg" alt="Lastochikino aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (-3, -2)<br>
                    Red offset: (dy, dx) = (143, -3)<br>
                    Processing time: 16.4s
                </div>
            </div>
            <div class="image-result">
                <span class="method-badge multi-scale">Pyramid NCC</span>
                <h4>lugano.tif</h4>
                <img src="output/lugano_restored.jpg" alt="Lugano aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (23, -11)<br>
                    Red offset: (dy, dx) = (92, -28)<br>
                    Processing time: 14.8s
                </div>
            </div>
            <div class="image-result">
                <span class="method-badge multi-scale">Pyramid NCC</span>
                <h4>melons.tif</h4>
                <img src="output/melons_restored.jpg" alt="Melons aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (80, 10)<br>
                    Red offset: (dy, dx) = (177, 13)<br>
                    Processing time: 9.6s
                </div>
            </div>
            <div class="image-result">
                <span class="method-badge multi-scale">Pyramid NCC</span>
                <h4>self_portrait.tif</h4>
                <img src="output/self_portrait_restored.jpg" alt="Self_Portrait aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (71, -1)<br>
                    Red offset: (dy, dx) = (151, -4)<br>
                    Processing time: 13.9s
                </div>
            </div>
            <div class="image-result">
                <span class="method-badge multi-scale">Pyramid NCC</span>
                <h4>siren.tif</h4>
                <img src="output/siren_restored.jpg" alt="Siren aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (48, -7)<br>
                    Red offset: (dy, dx) = (99, -21)<br>
                    Processing time: 19.1s
                </div>
            </div>
            <div class="image-result">
                <span class="method-badge multi-scale">Pyramid NCC</span>
                <h4>three_generations.tif</h4>
                <img src="output/three_generations_restored.jpg" alt="Three_Generations aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (52, 5)<br>
                    Red offset: (dy, dx) = (110, 7)<br>
                    Processing time: 17.2s
                </div>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>üåü Library of Congress Collection (3 Master-PNP Files)</h2>
        <p>Additional images downloaded from the Prokudin-Gorskii collection:</p>
        
        <div class="image-grid">
            <div class="image-result">
                <span class="method-badge multi-scale">Pyramid NCC + Edges</span>
                <h4>master-pnp-prok-00000-00086a.tif</h4>
                <img src="output/master-pnp-prok-00000-00086a_restored.jpg" alt="Master-Pnp-Prok-00000-00086A aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (42, 6)<br>
                    Red offset: (dy, dx) = (87, 32)<br>
                    Processing time: 18.2s<br><strong>Note:</strong> Library of Congress collection
                </div>
            </div>
            <div class="image-result">
                <span class="method-badge multi-scale">Pyramid NCC + Edges</span>
                <h4>master-pnp-prok-00100-00116a.tif</h4>
                <img src="output/master-pnp-prok-00100-00116a_restored.jpg" alt="Master-Pnp-Prok-00100-00116A aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (33, 0)<br>
                    Red offset: (dy, dx) = (67, -26)<br>
                    Processing time: 16.7s<br><strong>Note:</strong> Library of Congress collection
                </div>
            </div>
            <div class="image-result">
                <span class="method-badge multi-scale">Pyramid NCC + Edges</span>
                <h4>master-pnp-prok-00100-00187u.tif</h4>
                <img src="output/master-pnp-prok-00100-00187u_restored.jpg" alt="Master-Pnp-Prok-00100-00187U aligned result">
                <div class="offset-table">
                    Green offset: (dy, dx) = (28, 12)<br>
                    Red offset: (dy, dx) = (74, 18)<br>
                    Processing time: 15.3s<br><strong>Note:</strong> Library of Congress collection
                </div>
            </div>
        </div>
    </div>

    <div class="bells-whistles">
        <h3>üî• Bells & Whistles Implementation</h3>
        <p>Advanced image enhancement features implemented beyond basic alignment:</p>
        
        <div class="feature-list">
            <div class="feature-item">
                <h4>üñºÔ∏è Automatic Border Cropping</h4>
                <p>Detects and removes colored glass plate borders using gradient analysis and edge detection.</p>
            </div>
            
            <div class="feature-item">
                <h4>‚öñÔ∏è Automatic White Balance</h4>
                <p>Gray World assumption: adjusts channel gains so average color becomes neutral gray.</p>
            </div>
            
            <div class="feature-item">
                <h4>üåà Automatic Contrast Enhancement</h4>
                <p>Percentile-based histogram stretching (2%-98%) for optimal dynamic range per channel.</p>
            </div>
            
            <div class="feature-item">
                <h4>üîç Edge-Based Features</h4>
                <p>Sobel gradient magnitude features robust to brightness differences between channels.</p>
            </div>
        </div>
    </div>

    <div class="section">
        <h2>üîß Technical Implementation</h2>
        
        <h3>Algorithm Pipeline:</h3>
        <ol>
            <li><strong>Load & Preprocess:</strong> Handle 16-bit TIFF and 8-bit JPEG, normalize for processing</li>
            <li><strong>Channel Splitting:</strong> Divide vertical glass plate into B, G, R thirds</li>
            <li><strong>Feature Extraction:</strong> Compute Sobel edge features for robust matching</li>
            <li><strong>Alignment:</strong> Single-scale (JPEGs) or multi-scale pyramid (TIFFs)</li>
            <li><strong>Reconstruction:</strong> Apply computed offsets to original high-bit-depth channels</li>
            <li><strong>Enhancement:</strong> Auto-crop, white balance, contrast adjustment</li>
        </ol>
        
        <h3>Key Parameters:</h3>
        <ul>
            <li><code>search_range=15</code>: Maximum displacement window</li>
            <li><code>pyramid_depth=5</code>: Number of pyramid levels (handles up to 480px displacement)</li>
            <li><code>crop_ratio=0.15</code>: Border cropping to avoid edge artifacts</li>
            <li><code>NCC metric</code>: Normalized Cross-Correlation for scoring</li>
        </ul>
        
        <h3>Performance Summary:</h3>
        <ul>
            <li><strong>JPEG files (3):</strong> Average 0.8s (single-scale)</li>
            <li><strong>Main TIFF files (11):</strong> Average 14.3s (pyramid alignment)</li>
            <li><strong>Master-PNP files (3):</strong> Average 16.7s (pyramid alignment)</li>
            <li><strong>Memory efficient:</strong> Processes images up to 3000x9000 pixels</li>
            <li><strong>Total processing time:</strong> ~210 seconds for all images</li>
        </ul>
    </div>

    <div class="section">
        <h2>üéì What We Covered</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; border-left: 4px solid #4caf50;">
                ‚úÖ <strong>Single-scale alignment</strong><br>
                Results on 3 JPEG files with computed offsets
            </div>
            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; border-left: 4px solid #4caf50;">
                ‚úÖ <strong>Multi-scale pyramid alignment</strong><br>
                Results on 11 provided TIFF examples
            </div>
            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; border-left: 4px solid #4caf50;">
                ‚úÖ <strong>NCC & L2 metrics</strong><br>
                NCC implemented and used by default
            </div>
            <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; border-left: 4px solid #4caf50;">
                ‚úÖ <strong>Additional collection images</strong><br>
                3+ images from LoC Prokudin-Gorskii collection
            </div>
        </div>
    </div>

    <div style="text-align: center; margin: 40px 0; color: #666;">
        <p>Created for CS Computer Vision Assignment - Prokudin-Gorskii Image Alignment</p>
        <p><strong>Source Code: <a href="https://github.com/Mohak327/rgb-img-merging/tree/main">https://github.com/Mohak327/rgb-img-merging/tree/main</a></strong></p>
        <p><strong>Submitted By: Mohak Sharma (ms7306)</strong></p>
    </div>
</body>
</html>